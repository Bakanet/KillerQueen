Debugging un peu complique et complexite des fonctions tres eclatee (je ne voyais pas d'autre facon de faire que des boucles dans des boucles sans passer par des listes).
L'explication des debugging se trouve dans les commentaires du code.